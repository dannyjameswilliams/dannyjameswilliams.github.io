<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>BERT | Danny James Williams</title>
    <link>https://dannyjameswilliams.co.uk/tag/bert/</link>
      <atom:link href="https://dannyjameswilliams.co.uk/tag/bert/index.xml" rel="self" type="application/rss+xml" />
    <description>BERT</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-gb</language><lastBuildDate>Fri, 21 Jan 2022 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://dannyjameswilliams.co.uk/images/icon_hu6de9a8f7dd4e8a8bd7c2613cf2ad59bf_37670_512x512_fill_lanczos_center_2.png</url>
      <title>BERT</title>
      <link>https://dannyjameswilliams.co.uk/tag/bert/</link>
    </image>
    
    <item>
      <title>Exploring Natural Language Embeddings of A Game of Thrones</title>
      <link>https://dannyjameswilliams.co.uk/post/asoiaf/</link>
      <pubDate>Fri, 21 Jan 2022 00:00:00 +0000</pubDate>
      <guid>https://dannyjameswilliams.co.uk/post/asoiaf/</guid>
      <description>
&lt;script src=&#34;https://dannyjameswilliams.co.uk/post/asoiaf/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;For those of you familiar with either HBO’s Game of Thrones, or George RR Martin’s A Song of Ice and Fire (ASOIAF), you will probably be aware of the vast differences between each character and the depth of each storyline. For those of you who aren’t familiar; each book chapter is written from the perspective of a different character, and George RR Martin writes each character in a distinct and unique way. A chapter written from the perspective of Eddard Stark, an aged and grizzled war veteran, will be portrayed vastly different to a chapter from the perspective of his son, Bran Stark, a 9 year old innocent ‘sweet summer child’.&lt;/p&gt;
&lt;p&gt;The stories surrounding all of the characters span continents, explore diverse themes and face different problems, and so we would expect there to be intrinsic differences between the language used for all of these different perspectives. &lt;em&gt;Can we use Natural Language Processing (NLP) to show how George RR Martin writes each of these characters?&lt;/em&gt; More specifically, is there actually a &lt;em&gt;mathematical difference&lt;/em&gt; between the chapters, grouped by character, based on the language alone?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A note on spoilers&lt;/strong&gt;: I am not including any excerpts from either the books or the show, and do not discuss the story. However, you will be able to see how many chapters are included for each character, as well as if any characters &lt;em&gt;stop&lt;/em&gt; having point-of-view chapters after a specific book.&lt;/p&gt;
&lt;div id=&#34;how-are-we-going-to-use-nlp-for-game-of-thrones&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;How are we going to use NLP for Game of Thrones?&lt;/h2&gt;
&lt;p&gt;To show how characters are different amongst the ASOIAF books, I will use &lt;a href=&#34;https://arxiv.org/pdf/1810.04805.pdf&#34;&gt;BERT&lt;/a&gt;, which is a NLP model built by Google, and an extremely powerful tool which can output &lt;em&gt;sentence embeddings&lt;/em&gt;. Put simply, a sentence embedding is a sequence of words, e.g. a sentence, which has been converted to a very high-dimensional mathematical vector. The vector itself won’t have any meaning to you or I on its own, but it has context relative to other sentences. For example, if two different sentence embeddings are very far away from each other, we can probably infer that the two original sentences are quite different.&lt;/p&gt;
&lt;p&gt;BERT can achieve this as it has been trained on a large corpus of language data: &lt;a href=&#34;https://arxiv.org/pdf/1506.06724.pdf&#34;&gt;a dataset of books&lt;/a&gt; and the full English Wikipedia. One way in which BERT trains is by &lt;em&gt;masked language modelling&lt;/em&gt;, which means it tries to predict random words in the dataset using the ‘transformer’ architecture, which is an extremely clever way of incorporating left-to-right and right-to-left directionality in a sentence so that the full context of the word is integrated. By learning where words come in the context of a sentence, BERT learns a lot about the English language. Whilst we aren’t trying to predict any words for our task, we will use the information that BERT learned whilst training as our emebeddings.&lt;/p&gt;
&lt;p&gt;Fortunately for us, BERT is made completely open-source and free to use via &lt;a href=&#34;https://huggingface.co/bert-base-uncased&#34;&gt;Huggingface&lt;/a&gt;, a collection of NLP models, datasets, and more. We can extract the embeddings from BERT and visualise them for each chapter to see if there is a strong degree of separation, which would indicate key differences in the language for different characters.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;asoiaf-embeddings&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;ASOIAF Embeddings&lt;/h1&gt;
&lt;p&gt;We can give BERT a sentence from ASOIAF, and it will output a relevant vector which gives information about this sentence. Repeating this for every sentence in the ASOIAF book series, we can obtain the high-dimensional sentence embeddings from each chapter of ASOIAF, by grouping by chapter and taking the average embedding across sentences.&lt;/p&gt;
&lt;p&gt;The embedding dimension output given by the base BERT model is 768, which we definitely cannot visualise. For this reason I have used &lt;a href=&#34;https://umap-learn.readthedocs.io/en/latest/&#34;&gt;UMAP&lt;/a&gt;&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;, a low-dimension projection method, to reduce the dimension to 3 so that we can visualise it.&lt;/p&gt;
&lt;div id=&#34;separation-by-character&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Separation by Character&lt;/h2&gt;
&lt;p&gt;Below I have plotted the (now 3D) embeddings in an interactive scatter plot, which you can rotate and move around. You can hover over each point to see the point-of-view character for each chapter and the corresponding book, as well as click on character names on the legend to remove them.&lt;/p&gt;
&lt;figure class=&#34;image&#34;&gt;
&lt;center&gt;
&lt;iframe height=&#34;750&#34; frameborder=&#34;0&#34; scrolling=&#34;no&#34; width=&#34;100%&#34; src=&#34;//plotly.com/~dannyjameswilliams/169.embed?autosize=true&amp;amp;link=false&amp;amp;modebar=false&#34;&gt;
&lt;/iframe&gt;
&lt;figcaption&gt;
Mean BERT sentence embeddings of chapters in ASOIAF, split by character (with each book labelled), restricted to the 10 most frequently occuring point-of-view characters. The dimension was reduced from 768 to 3 using UMAP. &lt;a href=&#34;https://chart-studio.plotly.com/~dannyjameswilliams/169/#/&#34;&gt;See in fullscreen here&lt;/a&gt;.
&lt;/figcaption&gt;
&lt;/center&gt;
&lt;/figure&gt;
&lt;p&gt;It is important to note that &lt;em&gt;no information about the classes (chapters/characters) was used at any point&lt;/em&gt;, so any structure we can see that separates the different characters or chapters is purely based on the language alone. The factors that could influence this are, for example: word choice, writing style, sentence length, and more.&lt;/p&gt;
&lt;p&gt;So what can we infer from this? The key aspects we are looking for are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How clustered are chapters from the same character?&lt;/li&gt;
&lt;li&gt;How separated are chapters from different characters?&lt;/li&gt;
&lt;li&gt;Are similar characters close to one another?&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;my-interpretation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;My Interpretation&lt;/h3&gt;
&lt;p&gt;From what I can see, the honourable and consistent Eddard Stark occupies a distinct region of the plot, and doesn’t stray far from it, but he is joined by other chapters from the first book. Daenerys’s storyline is mostly separated from the rest of the characters, so it makes sense that her chapters are grouped together and distinct in the plot. Other characters, such as Arya, seem to be uniquely identifiable due to being separated from the other clusters. The questionably lovable dwarf, Tyrion, has a plotline which spans battlefields, court intrigue, romance, death, and more. This seems to be shown here by his embeddings being spread across the entire space, representing the large variability in his changing viewpoints and scenarios.&lt;/p&gt;
&lt;p&gt;Surprisingly, I expected the child characters, most notably Sansa and Bran, to occupy a distinct region because of their naive and childlike viewpoints, but their distributions aren’t too different from most other characters. In fact, Jon’s and Bran’s chapters seem to exist in the same regions of the plot, which could indicate a similarity in the characters, or at least how the characters are written.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;separation-by-book&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Separation by Book&lt;/h2&gt;
&lt;p&gt;There seems to be a divide based on the book which each chapter is written in. Just by switching the labels (and removing the top 10 character restriction), we can inspect the same plot with a different angle.&lt;/p&gt;
&lt;figure class=&#34;image&#34;&gt;
&lt;center&gt;
&lt;iframe height=&#34;750&#34; frameborder=&#34;0&#34; scrolling=&#34;no&#34; width=&#34;100%&#34; src=&#34;//plotly.com/~dannyjameswilliams/171.embed?autosize=true&amp;amp;link=false&amp;amp;modebar=false&#34;&gt;
&lt;/iframe&gt;
&lt;figcaption&gt;
Mean BERT sentence embeddings of chapters in ASOIAF, split by book. The dimension was reduced from 768 to 3 using UMAP. &lt;a href=&#34;https://chart-studio.plotly.com/~dannyjameswilliams/171/#/&#34;&gt;See in fullscreen here&lt;/a&gt;.
&lt;/figcaption&gt;
&lt;/center&gt;
&lt;/figure&gt;
&lt;p&gt;The divide between classes is far more clear in this case&lt;a href=&#34;#fn2&#34; class=&#34;footnote-ref&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; - books 2 and 3 (ACOK and ASOS respectively), are far, far, different from the other books in the series. The first, fourth and fifth books (AGOT, AFFC and ADWD respectively), are more closely related, with the first book being in a more distinctive class. Books 4 and 5 were written at the same time, which might explain their embeddings being so intertwined.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;final-thoughts&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Final Thoughts&lt;/h1&gt;
&lt;p&gt;It is interesting how we can &lt;em&gt;mathematically see the difference in language&lt;/em&gt; based on the book or the character. There is a clear mathematical distinction between writing styles used for different characters, and we have even shown the evolution of George RR Martin’s prose over the course of writing the ASOIAF series.&lt;/p&gt;
&lt;p&gt;We can see the potential usefulness of these BERT embeddings, and they have far more use outside of plotting them to see their groups. We could’ve calculated the distance between embeddings to see exactly which characters are the most different or the most similar. We could use the embeddings themselves in a data science application; for example, how well can we classify which character is being written about based on only language?&lt;/p&gt;
&lt;p&gt;Existing research in NLP has given us the avenue to do all of this. It is an extremely interesting field, and is constantly developing. The methods we used here are free, and open to anyone for experimenting with. What other applications do you think would be cool to see? If you would like to ask any questions or have any discussion, &lt;a href=&#34;https://dannyjameswilliams.co.uk/#contact&#34;&gt;see my contact page&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;The UMAP transform was fit with hyperparameters &lt;code&gt;min_dist = 0&lt;/code&gt; and &lt;code&gt;n_neighbors = 30&lt;/code&gt;, chosen by trial and error, to try to separate the classes as much as possible. All other values were kept as default in &lt;a href=&#34;https://umap-learn.readthedocs.io/en/latest/api.html#umap&#34;&gt;this function&lt;/a&gt;&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;For completeness, here are the initialisms used for each book. AGOT: A Game of Thrones, ACOK: A Clash of Kings, ASOS: A Storm of Swords, AFFC: A Feast for Crows, ADWD: A Dance with Dragons&lt;a href=&#34;#fnref2&#34; class=&#34;footnote-back&#34;&gt;↩︎&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
